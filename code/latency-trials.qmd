---
title: "Effect of trial order on latency to open door of testbox"
author: "Liza Moscovice, Anja Eggert and Jean-Loup Rault"
date: "`r Sys.Date()`" 
editor: visual
code-fold: false
toc: true
format: html
self-contained: true
---

# Libraries

```{r, warning=FALSE, message=FALSE, echo=TRUE}
library(tidyverse)     # tidy universe
library(viridis)       # viridis colours
```

```{r, echo = FALSE}
my_theme = theme_classic() +
  theme(axis.title = element_text(face="bold", size=14),
        axis.text  = element_text(size=12, angle = 0, vjust = 0.5),
        plot.title = element_text(face="bold", size=14),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

```{r}
set.seed(1989)
```

# Task

Test for effect of trial order on latency to open door, for test box and empty box.

# Read data

```{r, warning = FALSE}
dat <- read_csv("../data/latency-trials.csv")
```

# Adjust data types

```{r}
dat <- dat %>% 
  mutate_at(vars(trapped.order), ~as.factor(.))
```

# Plot

```{r}
plot <- dat %>%
  ggplot() +
  geom_boxplot(data = subset(dat, helper == "Pig"),
               aes(x = trapped.order, 
                   y = lat.helped.min),
               outlier.shape = NA, width = 0.5, col = "orchid", show.legend = FALSE) +
  geom_point(aes(x     = trapped.order, 
                 y     = lat.helped.min,
                 col   = id.group,
                 shape = helper),
             position = position_jitterdodge(jitter.width  = 0.9,
                                             jitter.height = 0.0,
                                             dodge.width   = 0.5),
             size = 3, alpha = 0.5) +
  # only legend for helped = yes
  scale_shape_manual(values = c(17, 19),
                     labels = c("Pig released by human", "")) +
  scale_color_manual(values = viridis(n=8),
                     guide="none") +
  scale_y_continuous(lim = c(0, 20.01), breaks = seq(0, 20, 5)) +
  labs(x = "Test trial",
       y = "Latency to first open door (min)",
       shape = "") +
  my_theme +
  # change only the legend appearance without affecting the plot
  # increase symbol size, remove symbol for pig
  guides(shape = guide_legend(override.aes = list(size  = 4,
                                                  shape = c(17, NA)))) +
  # legend position: c(0,0) “bottom left” and c(1,1) “top right”
  # legend appearance
  theme(legend.justification = c(1,0.6),
        legend.position = c(1,0.6),
        legend.background = element_rect(fill = NA, colour ="black",
                                         size=0.3, linetype="solid"),
        legend.text = element_text(size=12))
```

```{r, fig.height=10, fig.width=10, warning=FALSE}
plot
```

# How to cite R

"All analyses were performed using R Statistical Software (version 4.2.0; R Core Team 2022)".

Reference: R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

```{r}
citation()
version$version.string
```

```{r}
citation("tidyverse")
citation("viridis")
```

# Session Info

```{r}
sessionInfo()
```
