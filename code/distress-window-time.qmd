---
title: "Distress & investigasting window"
author: "Liza Moscovice, Anja Eggert and Jean-Loup Rault"
date: "`r Sys.Date()`" 
editor: visual
code-fold: false
toc: true
format: html
---

# Libraries

```{r, libraries, warning=FALSE, message=FALSE, echo=TRUE}
library(tidyverse)     # tidy universe
library(patchwork)     # combine plots
```

```{r, my_theme, echo = FALSE}
my_theme = theme_classic() +
  theme(axis.title = element_text(face="bold", size=14),
        axis.text  = element_text(size=12, angle = 0, vjust = 0.5),
        plot.title = element_text(face="bold", size=14),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

```{r, seed}
set.seed(1989)
```

# Data

Data analysis from the point of view of the helping pigs.

## Read data

```{r, data, warning = FALSE}
dat <- read_csv("../data/distress-window-time.csv")
```

## Adjust data types

```{r, data-adj}
dat <- dat %>% 
  # factors
  mutate_at(vars(group.trapped.pig.order), ~as.factor(.)) %>% 
  # total distress
  mutate(distress = screams+escapes) %>% 
  # rates per min
  mutate(distress.rate.per.min = distress/(interval.dur/60)) %>% 
  mutate(window.rate.per.min   = invest.window/(interval.dur/60))

str(dat)
```

# Plot

-   visualize distress signal over time

```{r, plot-1}
plot.d <- dat %>% 
  ggplot(aes(x     = interval_count,
             y     = distress.rate.per.min,
             group = interval_count)) + 
  geom_boxplot(width = 0.5, color = "#b22222") + 
  scale_x_continuous(limits = c(0.5, 20.5), 
                     breaks = seq(1, 20, by = 1)) +
  scale_y_continuous(limits = c(0, 14), 
                     breaks = seq(0, 14, by = 2)) +
  labs(x = "Minute interval",
       y = "Rate distress signals per minute") +
  my_theme +
  theme(legend.position = "none")
```

-   visualize investigating window over time

```{r, plot-2}
plot.w <- dat %>% 
  ggplot(aes(x     = interval_count,
             y     = window.rate.per.min,
             group = interval_count)) + 
  geom_boxplot(width = 0.5, color = "#440154FF") +  
  scale_x_continuous(limits = c(0.5, 20.5), 
                     breaks = seq(1, 20, by = 1)) +
  scale_y_continuous(limits = c(0, 14), 
                     breaks = seq(0, 14, by = 2)) +
  labs(x = "Minute interval",
       y = "Rate investigating window per minute") +
  my_theme +
  theme(legend.position = "none")
```

-   combine plots

```{r, plot-3}
plot <- plot.d/plot.w
```

```{r, plot-4, fig.height=12, fig.width=10, warning=FALSE}
plot +
  plot_annotation(tag_levels = 'a')
```

# How to cite R

"All analyses were performed using R Statistical Software (version 4.2.0; R Core Team 2022)".

Reference: R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

```{r, cite-r}
citation()
version$version.string
```

```{r, cite-packages}
citation("tidyverse")
citation("patchwork")
```

# Session Info

```{r, session}
sessionInfo()
```
